<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1255">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.0  (Win32)">
	<META NAME="CREATED" CONTENT="20090426;7275700">
	<META NAME="CHANGED" CONTENT="20090601;23372100">
	<META NAME="Info 1" CONTENT="">
	<META NAME="Info 2" CONTENT="">
	<META NAME="Info 3" CONTENT="">
	<META NAME="Info 4" CONTENT="">
</HEAD>
<BODY LANG="zxx" DIR="LTR">
<P ALIGN=CENTER><FONT FACE="Times New Roman, serif"><FONT SIZE=6><SPAN LANG="en-US">bitstring</SPAN></FONT></FONT></P>
<P ALIGN=CENTER><FONT FACE="Times New Roman, serif"><FONT SIZE=4><SPAN LANG="en-US">Binary
string parsing and creation library for Lua</SPAN></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US"><BR></SPAN></FONT><FONT FACE="Times New Roman, serif"><FONT SIZE=5><SPAN LANG="en-US">Overview</SPAN></FONT></FONT><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US"><BR>The
bitstring library provides facilities to create and parse binary
strings as arbitrary collection of bits. It is inspired by Erlang bit
syntax but is not a copy of it. The goal of bitstring project is to
ease implementation of and experimentation with binary protocols from
Lua - especially protocols based on bits. The bitstring library
doesn't need any modification of Lua syntax. It is released under the
flexible BSD license and is freely available from
<A HREF="http://luaforge.net/projects/bitstring/" NAME="bitstring main">http://luaforge.net/projects/bitstring/</A><BR><BR></SPAN></FONT><FONT FACE="Times New Roman, serif"><FONT SIZE=5><SPAN LANG="en-US">Example</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><FONT COLOR="#004586"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">--
This example demonstrates extraction and setting of bits in EAP-TLS
message<BR>-- EAP-TLS protocol defined in RFC 2716<BR></SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">code,
identifier, length, eap_type, L_bit, M_bit, S_bit, R_bits =
bitstring.unpack(<BR></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;8:int,
8:int, 16:int:big, 8:int, 1:int, 1:int, 1:int, 5:int&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
eap_tls_message);<BR><BR>composed_eap_tls_message =
bitstring.pack(<BR></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;8:int,
8:int, 16:int:big, 8:int, 1:int, 1:int, 1:int, 5:int&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
<BR>code, identifier, length, eap_type, L_bit, M_bit, S_bit, R_bits)</SPAN></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US">See
complete example bellow. </SPAN></FONT>
</P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif"><FONT SIZE=5><SPAN LANG="en-US">Development
Status</SPAN></FONT></FONT><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US"><BR>The
project is currently in a pre-alpha. The code works but is still not
fully optimized. Some changes to the interface are expected to
provide for more efficient usage. Please submit bugs to
<A HREF="http://luaforge.net/projects/bitstring/">http://luaforge.net/projects/bitstring/</A><BR>Suggestions
are welcome.<BR><BR></SPAN></FONT><FONT FACE="Times New Roman, serif"><FONT SIZE=5><SPAN LANG="en-US">Installation
on POSIX systems</SPAN></FONT></FONT><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US"><BR>For
detailed installation instructions see INSTALL<BR><BR></SPAN></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">$
./configure <BR>$ make check<BR>$ sudo make install</SPAN></FONT><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US"><BR><BR>to
install to non default location use --libdir<BR>for example <BR><BR></SPAN></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">$
./configure --libdir=/usr/local/lib/lua/5.1/</SPAN></FONT><FONT FACE="Times New Roman, serif">
</FONT></FONT>
</P>
<P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif"><FONT SIZE=5><SPAN LANG="en-US">Installation
on win32 from source</SPAN></FONT></FONT></FONT></P>
<UL>
	<LI><P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US">get
	and install Lua for Windows from <A HREF="http://luaforwindows.luaforge.net/">http://luaforwindows.luaforge.net/</A></SPAN></FONT></FONT></P>
	<LI><P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif">verify
	that LUA_DEV environment variable is set - </FONT><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US">on
	my computer it is set to C:\Program Files\Lua\5.1\</SPAN></FONT></FONT></P>
	<LI><P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US">get
	and install free Microsoft Visual C++ 2008 Express Edition from
	Microsoft</SPAN></FONT></FONT></P>
	<LI><P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US">copy
	the product dll into the clibs directory of lua for windows.   on my
	computer it is in C:\Program Files\Lua\5.1\clibs\</SPAN></FONT></FONT></P>
</UL>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US">win32
build uses stdint.h Copyright (c) 2006-2008 Alexander Chemeris. </SPAN></FONT>
</P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US">Please
see the copyright notice in ./win32/bitstring/bitstring/stdint.h</SPAN></FONT></P>
<P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif"><FONT SIZE=5><SPAN LANG="en-US">Installation
on win32 from prebuilt package</SPAN></FONT></FONT></FONT></P>
<UL>
	<LI><P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US">copy
	the bitstring.dll into the clibs directory of lua for windows.  on
	my computer it is in C:\Program Files\Lua\5.1\clibs\</SPAN></FONT></FONT></P>
</UL>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US">win32
build uses stdint.h Copyright (c) 2006-2008 Alexander Chemeris.</SPAN></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US">Please
see the copyright notice in
./win32/bitstring/bitstring/stdint.h<BR><BR></SPAN></FONT><FONT FACE="Times New Roman, serif"><FONT SIZE=5><SPAN LANG="en-US">Library
functions</SPAN></FONT></FONT><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US"><BR>Verify
that bitstring is on LUA_CPATH and <BR><BR></SPAN></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&gt;
require </SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;bitstring&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><BR>&gt;
result = bitstring.pack(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;1:int,
3:int, 5:int, 16:int:big&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
0x01, 0x04, 0xff, 0x0102)<BR>&gt; a, b, c, d =
bitstring.unpack(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;1:int,
3:int, 5:int, 16:int:big&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">)<BR>&gt;
result = bitstring.hexdump(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;abcd&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">)<BR>&gt;
result = bitstring.hexstream(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;abcd&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">)<BR>&gt;
result = bitstring.fromhexstream(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;000a0b0c&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">)<BR>&gt;
result = bitstring.bindump(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;abcd&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">)<BR>&gt;
result = bitstring.binstream(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;abcd&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">)<BR>&gt;
result = bitstring.frombinstream(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;001001010001001001110010&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">)</SPAN></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><A HREF="funcref.html" NAME="function reference"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US">For
detailed description see bitstring reference</SPAN></FONT></A></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif"><FONT SIZE=5><SPAN LANG="en-US">Related
work</SPAN></FONT></FONT><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US"><BR>bitlib
- small and elegant library for bitwise operations
<A HREF="http://luaforge.net/projects/bitlib">http://luaforge.net/projects/bitlib</A></SPAN></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><SPAN LANG="en-US"><BR></SPAN><FONT SIZE=5><SPAN LANG="en-US">More
examples</SPAN></FONT><SPAN LANG="en-US"><BR></SPAN><FONT SIZE=4 STYLE="font-size: 16pt"><SPAN LANG="en-US">RADIUS
message parser and composer</SPAN></FONT><SPAN LANG="en-US"><BR><BR></SPAN><FONT COLOR="#004586"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">--
parse-radius.lua <BR>-- This example demonstrates parsing and
creation of RADIUS protocol messages<BR>-- using bitstring.pack and
bitstring.unpack. It also uses bitstring.hexstream<BR>-- and
bitstring.fromhexstream utility functions that ease on debugging.<BR>--
RADIUS protocol is defined in RFC 2865.<BR>--
---------------------------------------<BR></SPAN></SPAN></FONT></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">require</SPAN></SPAN></FONT></FONT>
<FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;bitstring&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal"><BR><BR></SPAN></SPAN></FONT><FONT COLOR="#004586"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">--
copied from wireshark</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal"><BR>packet
=
</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;01e40088abe03a1b2b38bbd7edcf08b26334f417010867696f7261300c06000005781e10303034302e393661302e343931301f10303034302e393662312e653036330606000000015012efbdb1bd5e4fe4147a95a78d001c51844f0d0202000b0167696f7261303d06000000130506000044f504060a383e83200f63642d617031313230622d3031&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal"><BR><BR>radis_message
= bitstring.fromhexstream(packet)<BR><BR></SPAN></SPAN></FONT><FONT COLOR="#004586"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">--
parse radius message</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal"><BR>code,
identifier, message_length, authenticator, attributes =
<BR>&nbsp;&nbsp;&nbsp;&nbsp;bitstring.unpack(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;8:int,
8:int, 16:int:big, 16:bin, rest:bin&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,
radis_message)<BR><BR>attribute_list = {}<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">while</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(#attributes
&gt; 0) do<BR>&nbsp;&nbsp;&nbsp;&nbsp;number, length, attributes =
bitstring.unpack(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;8:int,
8:int, rest:bin&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,
attributes)<BR>&nbsp;&nbsp;&nbsp;&nbsp;value, attributes =
bitstring.unpack((length - 2) .. </SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;:bin,
rest:bin&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,
attributes)<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">table.insert</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(attribute_list,
{number = number, length = length, value = value})<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">end</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal"><BR><BR></SPAN></SPAN></FONT><FONT COLOR="#004586"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">--
compose radius message</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal"><BR>attributes
= {}<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">for</SPAN></SPAN></FONT></FONT>
<FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">i,
a in </SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">ipairs</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(attribute_list)
do<BR>&nbsp;&nbsp;&nbsp;&nbsp;attribute = bitstring.pack(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;8:int,
8:int, all:bin&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,
a.number, a.length, a.value)<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">table.insert</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(attributes,
attribute)<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">end</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal"><BR>attributes
= </SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">table.concat</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(attributes)<BR><BR>composed_message_length
= 20 + #attributes<BR>composed_radius_message =
bitstring.pack(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;8:int,
8:int, 16:int:big, 16:bin, all:bin&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,<BR>&nbsp;&nbsp;&nbsp;&nbsp;code,
identifier, composed_message_length, authenticator, attributes) <BR><BR></SPAN></SPAN></FONT><FONT COLOR="#004586"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">--
print results</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal"><BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;parsed
radius message&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">)<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;code:
&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,
code)<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;identifier:
&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,
identifier)<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;radius
message length: &quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,
message_length)<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;authenticator:
&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,
bitstring.hexstream(authenticator))<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;attributes:&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">)<BR><BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">for</SPAN></SPAN></FONT></FONT>
<FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">i,
attribute in </SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">ipairs</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(attribute_list)
do<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;--------------------------------------&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">)<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;
number: &quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,
attribute.number)<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;
length: &quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,
attribute.length)<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;
value: &quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">,
bitstring.hexstream(attribute.value))<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">end</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal"><BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;--------------------------------------&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">)<BR><BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(</SPAN></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">&quot;composed
radius
message&quot;</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">)<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">print</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(bitstring.hexstream(composed_radius_message))<BR></SPAN></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">assert</SPAN></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">(composed_radius_message
== radis_message)</SPAN></SPAN></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><BR></SPAN></FONT><SPAN LANG="en-US"><BR></SPAN><FONT SIZE=5><SPAN LANG="en-US">EAP-TLS
message parser and composer</SPAN></FONT><SPAN LANG="en-US"><BR><BR></SPAN><FONT COLOR="#004586"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">--
parse-eap-tls.lua<BR>-- This example demonstrates extraction and
setting of bits in EAP-TLS message<BR>-- EAP-TLS protocol defined in
RFC 2716<BR></SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><BR></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">require</SPAN></FONT></FONT>
<FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;bitstring&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><BR><BR>packet
= </SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;010000060d20&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US"><BR><BR>eap_tls_message
= bitstring.fromhexstream(packet)<BR><BR>code, identifier, length,
eap_type, L_bit, M_bit, S_bit, R_bits = bitstring.unpack(<BR></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;8:int,
8:int, 16:int:big, 8:int, 1:int, 1:int, 1:int, 5:int&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
eap_tls_message);<BR><BR>composed_eap_tls_message =
bitstring.pack(<BR></SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;8:int,
8:int, 16:int:big, 8:int, 1:int, 1:int, 1:int, 5:int&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
<BR>code, identifier, length, eap_type, L_bit, M_bit, S_bit,
R_bits)<BR><BR></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">print</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;code:
&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
code)<BR></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">print</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;identifier:
&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
identifier)<BR></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">print</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;length:
&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
length)<BR></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">print</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;eap_type:
&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
eap_type)<BR></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">print</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;L_bit:
&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
L_bit)<BR></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">print</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;M_bit:
&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
M_bit)<BR></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">print</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;S_bit:
&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
S_bit)<BR></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">print</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">(</SPAN></FONT><FONT COLOR="#c5000b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">&quot;R_bits:
&quot;</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">,
R_bits)<BR><BR></SPAN></FONT><FONT COLOR="#006b6b"><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">assert</SPAN></FONT></FONT><FONT FACE="Courier New, monospace"><SPAN LANG="en-US">(eap_tls_message
== composed_eap_tls_message)</SPAN></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=5><SPAN LANG="en-US">Credits</SPAN></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=4><SPAN LANG="en-US">Thanks
to Slava Chernoy for suggesting the compile feature and reminding me
again when I didn't implement it.</SPAN></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=5><SPAN LANG="en-US">What's
new</SPAN></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=4><SPAN LANG="en-US"><B>pre-alpha-0-1</B>
</SPAN></FONT></FONT>
</P>
<UL>
	<LI><P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT SIZE=4><SPAN LANG="en-US">substring
	parameters &ndash; provide more efficient interface for parsing</SPAN></FONT></FONT></P>
	<LI><P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT SIZE=4><SPAN LANG="en-US">bitstring.compile
	&ndash; interface to optimize processing of recurring bit patterns</SPAN></FONT></FONT></P>
	<LI><P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT SIZE=4><SPAN LANG="en-US">optimize
	packing of well aligned binary strings</SPAN></FONT></FONT></P>
	<LI><P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT SIZE=4><SPAN LANG="en-US">fixed
	bugs</SPAN></FONT></FONT></P>
</UL>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=4><SPAN LANG="en-US"><B>alpha-0-2</B></SPAN></FONT></FONT></P>
<UL>
	<LI><P ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT SIZE=4><SPAN LANG="en-US"><SPAN STYLE="font-weight: normal">basic
	support for floating point numbers</SPAN></SPAN></FONT> </FONT>
	</P>
</UL>
<P ALIGN=LEFT STYLE="margin-left: 0.4cm"><BR><BR>
</P>
</BODY>
</HTML>